<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Price Monitor</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation/dist/chartjs-plugin-annotation.min.js"></script>
    
    <!-- SheetJS for .xlsx export -->
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

    <!-- jspreadsheet and Material Icons libraries -->
    <script src="https://bossanova.uk/jspreadsheet/v5/jspreadsheet.js"></script>
    <script src="https://jsuites.net/v5/jsuites.js"></script>
    <link rel="stylesheet" href="https://bossanova.uk/jspreadsheet/v5/jspreadsheet.css" type="text/css" />
    <link rel="stylesheet" href="https://jsuites.net/v5/jsuites.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons" />
    
    <!-- Marked.js for Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        :root {
            --bg-color: #ffffff;
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --text-primary: #2c3e50;
            --text-secondary: #555;
            --border-color: transparent;
            --header-bg: #f8f9fa;
            --hover-bg: #f5f5f5;
            --primary-color: #4a90e2;
            --positive-color: #d32f2f;
            --negative-color: #008000;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: var(--text-primary);
        }
        .container { max-width: 1900px; margin: 0 auto; padding: 15px; }

        #loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.8); display: flex;
            justify-content: center; align-items: center; flex-direction: column;
            z-index: 9999; color: white;
        }
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.2); width: 48px; height: 48px;
            border-radius: 50%; border-left-color: var(--primary-color);
            animation: spin 1s ease infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .main-content {
            background: var(--bg-color); border-radius: 12px;
            padding: 25px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-top: 10px;
        }

        /* Simplified Header for Single Tab View */
        .header-bar {
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #eee; margin-bottom: 20px;
            padding-bottom: 10px;
        }
        .app-title { font-size: 1.5rem; font-weight: bold; color: var(--text-primary); }

        /* Market Cap (Price) Tab Styles */
        .mc-container {
            background-color: white;
            padding: 10px;
            overflow-x: auto;
            border-radius: 8px;
        }
        .mc-header {
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 15px;
            background: #f8f9fa; padding: 10px; border-radius: 8px;
        }
        
        .mc-settings-left {
            display: flex; align-items: center; gap: 10px;
        }
        
        .mc-settings-right {
            display: flex; align-items: center; gap: 10px; margin-left: auto;
        }
        
        .mc-settings-group label { font-size: 0.9rem; font-weight: 500; color: #555; }

        .mc-wrapper {
            transform-origin: top left;
            transition: transform 0.2s;
            width: fit-content;
            min-width: 100%;
        }
        
        /* Grid Layout Configuration */
        .mc-grid-top {
            display: flex; 
            flex-direction: column; /* Force Stacked Layout (Rows) */
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .mc-block {
            padding: 5px;
            background: white;
            width: 100%;
        }
        .mc-block-title {
            font-weight: bold; font-size: 1.1rem; margin-bottom: 10px;
            text-align: left; color: black;
            border-bottom: 2px solid black;
            padding-bottom: 5px;
            padding-left: 5px;
        }
        
        .mc-table {
            border-collapse: collapse; font-size: 0.85rem; 
            table-layout: fixed; /* Fixed layout ensures alignment */
        }
        .mc-table th, .mc-table td {
            border: none;
            padding: 0 4px; 
            text-align: center; /* Center alignment by default */
            white-space: nowrap;
            height: 30px;
            line-height: 30px;
        }
        .mc-table th {
            background-color: white; 
            font-weight: 600;
            border-bottom: 1px solid #333;
            overflow: hidden; text-overflow: ellipsis;
        }
        
        /* Fixed Column Widths for Alignment */
        .mc-col-date {
            width: 100px;
            min-width: 100px;
            text-align: center !important;
            color: #333;
        }
        
        .mc-col-ticker {
            width: 90px;
            min-width: 90px;
            max-width: 90px;
        }

        /* Inputs in Table */
        .cell-editable {
            width: 100%; border: none; background: transparent; 
            text-align: right; /* Values align right inside the centered flex container for better number readability */
            font-family: inherit; font-size: inherit;
            outline: none;
            cursor: text;
        }
        .cell-editable:focus { background: #e8f0fe; }
        
        .header-editable {
            width: 100%; border: none; background: transparent; 
            text-align: center; font-weight: bold; font-family: inherit;
            outline: none;
            cursor: pointer;
        }
        .header-editable:focus { border-bottom: 1px solid var(--primary-color); }

        /* Indicators */
        .triangle-up { color: red; margin-left: 2px; font-size: 0.8rem; display: inline-block; width: 12px; text-align: center; }
        .triangle-down { color: green; margin-left: 2px; font-size: 0.8rem; display: inline-block; width: 12px; text-align: center; }
        .triangle-placeholder { display: inline-block; width: 14px; margin-left: 2px; } /* Matches triangle width + margin */
        .dividend-mark { color: blue; font-weight: bold; margin-left: 1px; cursor: help; font-size: 0.9rem; }

        /* Controls */
        .controls-input {
            border: 1px solid #ccc; padding: 4px 8px; border-radius: 4px;
            background-color: white; cursor: pointer; font-size: 0.9rem;
            width: 100px;
        }
        .controls-input-sm {
            border: 1px solid #ccc; padding: 4px; border-radius: 4px;
            width: 60px; text-align: center;
        }

        /* Specific fix for date input size */
        #mc-as-of-date {
            padding: 2px 4px;
            font-size: 0.85rem;
            width: auto;
            max-width: 125px; /* Restrict width */
            height: 28px;
        }
        
        /* Footnote Area */
        #footnote-area {
            margin-top: 30px;
            padding: 15px;
            border-top: 1px solid #333;
            background: white;
            min-height: 80px;
            font-size: 0.85rem;
            line-height: 1.5;
            color: #444;
            outline: none;
        }
        #footnote-area:focus { background: #f9f9f9; }
        #footnote-label { font-size: 0.8rem; color: #888; margin-bottom: 5px; font-weight: bold; }

        /* Print Styles - Optimized for Single Page Landscape */
        @media print {
            @page { size: landscape; margin: 5mm; } /* Small margins, Landscape */
            
            body { 
                background: white; 
                -webkit-print-color-adjust: exact; 
                print-color-adjust: exact;
                margin: 0;
                padding: 0;
            }
            
            .container { 
                max-width: none; 
                width: 100%; 
                margin: 0; 
                padding: 0; 
            }
            
            /* Hide UI elements */
            .header-bar, 
            .mc-header, 
            #loading-overlay, 
            #footnote-label,
            .mc-settings-left,
            .mc-settings-right { 
                display: none !important; 
            }
            
            .main-content {
                box-shadow: none;
                padding: 0;
                margin: 0;
                border: none;
            }
            
            .mc-container {
                padding: 0;
                border: none;
            }
            
            #market-cap-tab { 
                position: static; 
                width: 100%; 
                display: block;
            }
            
            .mc-wrapper { 
                /* Scale calculation: 
                   Page width ~297mm (A4 Landscape). 
                   15 cols * ~90px + 100px date ~= 1450px content.
                   Approx scale 0.65 fits comfortably. 
                */
                transform: scale(0.65); 
                transform-origin: top left; 
                width: 145%; /* Compensate for scale down to fill width */
            }
            
            .mc-block {
                break-inside: avoid; 
                page-break-inside: avoid;
                margin-bottom: 10px;
                padding: 0;
            }
            
            /* Clean up table for print */
            .mc-table th { border-bottom: 1px solid #000; }
            input { border: none; background: transparent; appearance: none; }
            
            /* Footnote */
            #footnote-area { 
                border-top: 1px solid black; 
                margin-top: 5px;
                padding-top: 5px;
                font-size: 9pt;
                min-height: auto;
            }
            
            /* Ensure colors print */
            .triangle-up { color: red !important; }
            .triangle-down { color: green !important; }
            .dividend-mark { color: blue !important; }
        }
    </style>
</head>
<body>
    <div id="loading-overlay">
        <div class="spinner"></div>
        <p id="loading-text" style="margin-top:20px;">Loading Data...</p>
    </div>

    <!-- Datalist for Ticker Selection -->
    <datalist id="ticker-options"></datalist>

    <div class="container">
        <div class="main-content">
            <div class="header-bar">
                <div class="app-title"><i class="material-icons" style="vertical-align: text-bottom;">price_check</i> Market Price Monitor</div>
                <div style="font-size: 0.9rem; color: #666;">
                    All cells editable | 15 Tickers per Row
                </div>
            </div>

            <div id="market-cap-tab">
                <div class="mc-header">
                    <div class="mc-settings-left">
                        <label>As of:</label>
                        <input type="date" id="mc-as-of-date" class="controls-input" onchange="renderMarketCapTable()">
                    </div>
                    
                    <div class="mc-settings-right">
                        <label>Lookback Days:</label>
                        <input type="number" id="setting-days" class="controls-input-sm" value="20" min="1" max="100" onchange="renderMarketCapTable()">
                        
                        <div style="border-left: 1px solid #ccc; height: 20px; margin: 0 10px;"></div>

                        <button class="controls-input" onclick="zoomTable(0.1)" style="width:40px; text-align:center;"><i class="material-icons" style="font-size:16px;">add</i></button>
                        <button class="controls-input" onclick="zoomTable(-0.1)" style="width:40px; text-align:center;"><i class="material-icons" style="font-size:16px;">remove</i></button>
                        <button class="controls-input" onclick="window.print()" style="width:auto;"><i class="material-icons" style="font-size:16px; vertical-align:text-bottom;">print</i> Print</button>
                    </div>
                </div>

                <div class="mc-container">
                    <div class="mc-wrapper" id="mc-wrapper">
                        <!-- Dynamic Grid -->
                        <div class="mc-grid-top" id="mc-grid"></div>
                        
                        <!-- Editable Footnote -->
                        <div style="margin-top: 20px;">
                            <div id="footnote-label">FOOTNOTES (Editable):</div>
                            <div id="footnote-area" contenteditable="true">
                                * Blue asterisk (*) indicates a potential dividend or ex-rights event (Price Return deviates from Total Return > 0.1%).<br>
                                △ indicates price increase. ▽ indicates price decrease.<br>
                                Prices for Taiwan stocks follow market tick rules (< 50: 2 decimals, 50-500: 1 decimal, >= 500: integer).<br>
                                Click any price to edit manually. Click any Ticker header to change the stock.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Configuration & Data ---
        const TICKER_NAMES = {
            '2330.TW': 'TSMC', 'TSM': 'TSMC ADR', '.TWII': 'TWSE', '.SOX': 'SOX', '.SPX': 'S&P 500', '.MCI': 'MCI',
            'NVDA': 'Nvidia', 'AAPL': 'Apple', 'AVGO': 'Broadcom', 'QCOM': 'Qualcomm', 'AMD': 'AMD',
            'INTC': 'Intel', '005930.KS': 'Samsung', '2303.TW': 'UMC', 'MSFT': 'Microsoft', 'GOOGL': 'Google',
            'AMZN': 'Amazon', 'META': 'Meta', 'TSLA': 'Tesla', 'ASML.AS': 'ASML', 'AMAT': 'AMAT',
            'KLAC': 'KLAC', 'LRCX': 'Lam Research', 'MU': 'Micron', 'TXN': 'TI', 'ADI': 'ADI',
            '2454.TW': 'MediaTek', '3711.TW': 'ASE', '2379.TW': 'Realtek', '3034.TW': 'Novatek',
            '6758.T': 'Sony', '8035.T': 'TEL', '6526.T': 'Socionext', '688981.SS': 'SMIC',
            '2388.TW': 'VIA', '3443.TW': 'GUC', '3661.TW': 'Alchip', '6669.TW': 'Wiwynn'
        };

        // Groups configuration: Exactly 2 groups, 15 tickers each
        // showDate: Both true so they align perfectly with same columns structure
        let marketGroups = [
            { 
                title: 'Key Indices & Foundries & AI Leaders', 
                showDate: true,
                tickers: [
                    '.SPX', '.SOX', '.TWII', '.MCI', '2330.TW', 
                    'TSM', 'INTC', '005930.KS', '2303.TW', '688981.SS',
                    'NVDA', 'AMD', 'AVGO', 'QCOM', '2454.TW'
                ] 
            },
            { 
                title: 'Equipment, Memory & Big Tech', 
                showDate: true,
                tickers: [
                    'ASML.AS', 'AMAT', 'LRCX', 'MU', '8035.T',
                    'AAPL', 'MSFT', 'GOOGL', 'AMZN', 'TSLA',
                    'META', 'TXN', 'ADI', '6758.T', '3711.TW'
                ] 
            }
        ];

        let allData = [];
        let dataByTicker = {};
        let summaryReferenceDate = new Date();
        let zoomLevel = 1.0;
        let allAvailableTickers = [];

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            window.addEventListener('resize', autoFitTable);
        });

        async function loadData() {
            const urls = [
                'https://raw.githubusercontent.com/andychu221/yhfinance-fred-data/main/market_data/Equity_Index.json',
                'https://raw.githubusercontent.com/andychu221/yhfinance-fred-data/main/market_data/TW_Stocks.json',
                'https://raw.githubusercontent.com/andychu221/yhfinance-fred-data/main/market_data/US_Stocks.json',
                'https://raw.githubusercontent.com/andychu221/yhfinance-fred-data/main/market_data/custom_index.json'
            ];

            try {
                const results = await Promise.all(urls.map(u => fetch(u).then(r => r.ok ? r.json() : null)));
                
                // Process Data
                results.forEach((json, idx) => {
                    if(!json) return;
                    const isMCI = idx === 3;
                    if(isMCI) {
                        if(json.data) processTickerData('.MCI', { date: Object.keys(json.data), close: Object.values(json.data) });
                    } else {
                        Object.entries(json).forEach(([t, d]) => processTickerData(t, d));
                    }
                });

                // Set latest date
                let maxTs = 0;
                Object.values(dataByTicker).forEach(arr => {
                    if(arr.length) {
                        const last = arr[arr.length-1].date.getTime();
                        if(last > maxTs) maxTs = last;
                    }
                });
                summaryReferenceDate = new Date(maxTs);
                document.getElementById('mc-as-of-date').value = summaryReferenceDate.toISOString().split('T')[0];

                // Populate Datalist
                allAvailableTickers = Object.keys(dataByTicker).sort();
                const datalist = document.getElementById('ticker-options');
                allAvailableTickers.forEach(t => {
                    const opt = document.createElement('option');
                    opt.value = t;
                    const name = TICKER_NAMES[t] || t;
                    opt.label = `${name} (${t})`;
                    datalist.appendChild(opt);
                });

                document.getElementById('loading-overlay').style.display = 'none';
                renderMarketCapTable();
                
                // Trigger auto fit after initial render
                setTimeout(autoFitTable, 100);

            } catch(e) {
                console.error(e);
                document.getElementById('loading-text').innerText = "Error loading data.";
            }
        }

        function processTickerData(rawTicker, data) {
            if(!data || !data.date || !data.close) return;
            
            // Clean Ticker Name
            let ticker = rawTicker;
            if (ticker.endsWith('.O') || ticker.endsWith('.N')) ticker = ticker.split('.')[0];
            if (ticker === 'TSM.N') ticker = 'TSM';

            const clean = [];
            const dates = data.date;
            const prices = data.close;
            const dailyRets = data.dailyTotalReturn || [];

            let prevTri = 100;

            for(let i=0; i<dates.length; i++) {
                const dStr = dates[i];
                if(dStr.includes('T') || dStr.includes(' ')) continue; 
                
                const p = prices[i];
                if(p == null) continue;
                
                // Calculate TRI
                let ret = 0;
                if(i > 0) {
                    if(dailyRets[i] != null) ret = dailyRets[i];
                    else if(prices[i-1]) ret = (p / prices[i-1]) - 1;
                }
                const tri = prevTri * (1 + ret);
                prevTri = tri;

                clean.push({
                    date: new Date(dStr),
                    price: p,
                    tri: tri
                });
            }
            
            if(!dataByTicker[ticker]) dataByTicker[ticker] = clean;
        }

        // --- Core Logic ---

        function getRecentTradingDays(anchor, daysCount) {
            const refTicker = dataByTicker['.SPX'] ? '.SPX' : (dataByTicker['2330.TW'] ? '2330.TW' : Object.keys(dataByTicker)[0]);
            const data = dataByTicker[refTicker];
            if(!data) return [];

            const anchorTime = anchor.getTime();
            const valid = data.filter(d => d.date.getTime() <= anchorTime);
            return valid.slice(-daysCount).map(d => d.date).reverse(); 
        }

        function getDataPoint(ticker, date) {
            const arr = dataByTicker[ticker];
            if(!arr) return null;
            const dTime = date.getTime();
            return arr.find(d => d.date.getTime() === dTime);
        }

        function getPrevDataPoint(ticker, date) {
            const arr = dataByTicker[ticker];
            if(!arr) return null;
            const dTime = date.getTime();
            const idx = arr.findIndex(d => d.date.getTime() === dTime);
            if(idx > 0) return arr[idx-1];
            return null;
        }

        function formatPrice(ticker, price) {
            if (price == null) return '-';
            
            // Japan (.T) and Korea (.KS) stocks: No decimals
            if (ticker.endsWith('.T') || ticker.endsWith('.KS')) {
                 return price.toLocaleString('en-US', { maximumFractionDigits: 0 });
            }

            // Taiwan Stocks Formatting
            const isTWStock = (ticker.endsWith('.TW') || ticker.endsWith('.TWO')) && !ticker.startsWith('.'); 
            
            let valStr = '';
            if (isTWStock) {
                if (price < 50) valStr = price.toFixed(2);
                else if (price < 500) valStr = price.toFixed(1);
                else valStr = price.toFixed(0);
            } else {
                valStr = price.toFixed(2);
            }
            
            const parts = valStr.split('.');
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            return parts.join('.');
        }
        
        // Auto fit table to viewport width
        function autoFitTable() {
            const wrapper = document.getElementById('mc-wrapper');
            const container = document.querySelector('.mc-container');
            if(!wrapper || !container) return;
            
            // Reset scale first to get true width
            wrapper.style.transform = 'scale(1)';
            
            const contentWidth = wrapper.scrollWidth;
            const containerWidth = container.clientWidth;
            
            // Calculate scale needed to fit
            // We add a small buffer to ensure no scrollbars
            let scale = containerWidth / (contentWidth + 20); 
            
            if (scale > 1.2) scale = 1.2; // Cap max zoom
            if (scale < 0.1) scale = 0.1; // Safety floor
            
            zoomLevel = scale;
            wrapper.style.transform = `scale(${zoomLevel})`;
        }

        // --- Rendering ---

        function renderMarketCapTable() {
            const container = document.getElementById('mc-grid');
            container.innerHTML = '';
            
            const dateInput = document.getElementById('mc-as-of-date').value;
            const daysCount = parseInt(document.getElementById('setting-days').value) || 20;
            
            const anchor = dateInput ? new Date(dateInput) : summaryReferenceDate;
            const dates = getRecentTradingDays(anchor, daysCount);

            if(dates.length === 0) {
                container.innerHTML = '<p>No data found for selected date.</p>';
                return;
            }

            marketGroups.forEach((group, gIdx) => {
                const block = document.createElement('div');
                block.className = 'mc-block';
                
                let html = `<div class="mc-block-title" contenteditable="true">${group.title}</div>`;
                html += `<table class="mc-table"><thead><tr>`;
                
                // Date Header
                html += `<th class="mc-col-date">Date</th>`;

                // Ticker Headers
                for(let i=0; i<15; i++) {
                    const t = group.tickers[i];
                    const val = t || '';
                    const name = t ? (TICKER_NAMES[t] || t) : '';
                    const display = name; // Use Name for display

                    html += `<th class="mc-col-ticker">
                        <input class="header-editable" list="ticker-options" 
                               value="${display}" 
                               onchange="updateTickerNameInput(${gIdx}, ${i}, this.value)" 
                               title="${t || ''}"
                               placeholder="Ticker">
                    </th>`;
                }
                html += `</tr></thead><tbody>`;

                // Rows (Dates)
                dates.forEach(date => {
                    const y = date.getFullYear();
                    const m = String(date.getMonth() + 1).padStart(2, '0');
                    const d = String(date.getDate()).padStart(2, '0');
                    const dateStr = `${y}/${m}/${d}`;
                    
                    html += `<tr>`;
                    html += `<td class="mc-col-date">${dateStr}</td>`;
                    
                    for(let i=0; i<15; i++) {
                        const t = group.tickers[i];
                        if(!t) {
                            html += `<td class="mc-col-ticker"></td>`;
                            continue;
                        }

                        const curr = getDataPoint(t, date);
                        const prev = getPrevDataPoint(t, date);
                        
                        let displayVal = '-';
                        let symbol = '<span class="triangle-placeholder"></span>'; // Default empty placeholder for alignment
                        let divMark = '';
                        
                        if(curr) {
                            displayVal = formatPrice(t, curr.price);
                            
                            if(prev) {
                                if(curr.price > prev.price) symbol = '<span class="triangle-up">△</span>'; 
                                else if(curr.price < prev.price) symbol = '<span class="triangle-down">▽</span>'; 
                                
                                const pRet = (curr.price / prev.price) - 1;
                                const tRet = (curr.tri / prev.tri) - 1;
                                if(Math.abs(pRet - tRet) > 0.001) {
                                    divMark = '<span class="dividend-mark" title="Dividend/Split Event">*</span>';
                                }
                            }
                        }
                        
                        html += `<td class="mc-col-ticker">
                            <div style="display:flex; justify-content:center; align-items:center;">
                                <div contenteditable="true" class="cell-editable">${displayVal}</div>
                                ${symbol}${divMark}
                            </div>
                        </td>`;
                    }
                    html += `</tr>`;
                });

                html += `</tbody></table>`;
                block.innerHTML = html;
                container.appendChild(block);
            });
            
            // Re-calculate fit after render
            autoFitTable();
        }

        // --- Interaction ---

        function updateTickerNameInput(gIdx, tIdx, val) {
            // User might type Name or Ticker.
            // Try to find Ticker from Name first
            let foundTicker = null;
            
            // Exact match Ticker
            if(dataByTicker[val]) foundTicker = val;
            else {
                // Find by Name in TICKER_NAMES
                const entry = Object.entries(TICKER_NAMES).find(([k, v]) => v === val || `${v} (${k})` === val);
                if(entry) foundTicker = entry[0];
            }

            if(foundTicker) {
                marketGroups[gIdx].tickers[tIdx] = foundTicker;
                renderMarketCapTable();
            } else if (val === "") {
                marketGroups[gIdx].tickers[tIdx] = "";
                renderMarketCapTable();
            }
        }

        function zoomTable(delta) {
            zoomLevel += delta;
            if(zoomLevel < 0.1) zoomLevel = 0.1;
            if(zoomLevel > 1.5) zoomLevel = 1.5;
            document.getElementById('mc-wrapper').style.transform = `scale(${zoomLevel})`;
        }
    </script>
</body>
</html>
